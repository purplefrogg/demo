{"version":3,"sources":["components/Pages/Users/Users.module.scss","components/common/Paginator/Paginator.module.scss","redux/users-selectors.ts","components/common/Paginator/Paginator.tsx","components/Pages/Users/User.tsx","components/Pages/Users/Search.tsx","components/Pages/Users/Users.tsx"],"names":["module","exports","getUsers","createSelector","state","usersPage","users","filter","u","getTotalCount","totalCount","getPage","page","getCount","count","getIsFetching","isFetching","getIsFollowing","isFollowing","getUsersFilter","Paginator","portionSize","onPageChanged","useState","Math","ceil","portionNumber","setPortionNumber","pagesCount","pages","i","push","portionCount","leftPortionPageNumber","rightPortionPageNumber","onClick","p","map","className","style","selectedPage","User","user","props","avatar","to","id","src","photos","small","alt","info","name","status","followed","disabled","some","unfollow","follow","Search","useSelector","enableReinitialize","initialValues","term","isFriend","String","friend","onSubmit","values","setSubmitting","onFilterChanged","isSubmitting","type","as","value","Users","dispatch","useDispatch","history","useHistory","Follow","unFollow","useEffect","parsed","queryString","location","search","substr","actualPage","actualFilter","requestUsers","pathname","Paginators","pageNumber","UsersPage"],"mappings":"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","file":"static/js/5.2cf39959.chunk.js","sourcesContent":["// extracted by mini-css-extract-plugin\nmodule.exports = {\"UsersPage\":\"Users_UsersPage__1RHKl\",\"User\":\"Users_User__2tHzA\",\"avatar\":\"Users_avatar__bxZOg\",\"info\":\"Users_info__1Tl2N\",\"selectedPage\":\"Users_selectedPage__2UnTv\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"selectedPage\":\"Paginator_selectedPage__1y9hK\"};","import { createSelector } from \"reselect\"\nimport { AppStateType } from \"./redux-store\"\n\nconst getUsersSelector = (state: AppStateType) => {\n    return state.usersPage.users\n}\nexport const getUsers = createSelector(getUsersSelector, (users) => {\n    return users.filter((u: any) => true)\n})\n    \nexport const getTotalCount = (state: AppStateType) => {\n    return state.usersPage.totalCount\n}\nexport const getPage = (state: AppStateType) => {\n    return state.usersPage.page\n}\nexport const getCount = (state: AppStateType) => {\n    return state.usersPage.count\n}\nexport const getIsFetching = (state: AppStateType) => {\n    return state.usersPage.isFetching\n}\nexport const getIsFollowing = (state: AppStateType) => {\n    return state.usersPage.isFollowing\n}\n\nexport const getUsersFilter = (state: AppStateType) => {\n    return state.usersPage.filter\n}\n\n","import React, { FC, useState } from 'react';\nimport style from './Paginator.module.scss'\n\ntype PropsType = {\n\tpage: number\n\tcount: number\n\ttotalCount: number\n\tportionSize?: number\n\n\tonPageChanged: (pageNumber: number) => void\n}\n\nconst Paginator: FC<PropsType> = ({count, totalCount, portionSize=10, page, onPageChanged}) => {\n\tlet [portionNumber, setPortionNumber] = useState(Math.ceil(page / portionSize))\n\n\tlet pagesCount = Math.ceil(totalCount / count)\n\tlet pages: Array<number> = []\n\tfor (let i = 1; i <= pagesCount; i++) {\n\t\tpages.push(i)\n\t}\n\n\tlet portionCount = Math.ceil(pagesCount / portionSize)\n\tlet leftPortionPageNumber = (portionNumber - 1) * portionSize + 1\n\tlet rightPortionPageNumber = portionNumber * portionSize\n\treturn (\n\t\t<div>\n\t\t\t{portionNumber > 1 &&\n\t\t\t\t<button onClick={() => setPortionNumber(portionNumber - 1)}>{'<<<'}</button>}\n\t\t\t{pages\n\t\t\t.filter(p => p >= leftPortionPageNumber && p <= rightPortionPageNumber)\n\t\t\t.map(p => <span key={p} onClick={() => { onPageChanged(p) }} className={p === page ? style.selectedPage : \"\"}>{p} </span>)}\n\t\t\t{portionCount > portionNumber &&\n\t\t\t<button onClick={() => setPortionNumber(portionNumber + 1)}>{'>>>'}</button>}\n\t\t</div>\n\t)\n\t}\nexport default Paginator;\n","import React, { FC } from 'react';\nimport { NavLink } from 'react-router-dom';\nimport { UserType } from '../../../redux/users-Reducer';\nimport style from './Users.module.scss'\n\ntype PropsType = {\n\tuser: UserType\n\tisFollowing: Array<number>\n\n\tfollow: (id: number)=> void\n\tunfollow: (id: number)=> void\n}\n\nconst User: FC<PropsType> = ({user, ...props}) => {\n\treturn (\n\t\t<div className={style.User} key={user.id}>\n\t\t\t<NavLink className={style.avatar} to={`/Profile/${user.id}`}>\n\t\t\t\t<img src={user.photos.small === null ? 'https://sun9-34.userapi.com/impf/c845420/v845420775/bafaa/hP5ZTk4e-O0.jpg?size=200x200&quality=96&proxy=1&sign=c915e9a943591bf8db59656c689429e4&type=album'\n\t\t\t\t: user.photos.small}\n\t\t\t\t\talt=\"\" /></NavLink>\n\t\t\t<div className={style.info}>\n\t\t\t\t<div className={style.name}>{user.name}</div>\n\t\t\t\t<div className={style.status}>{user.status}</div>\n\t\t\t</div>\n\t\t\t{user.followed ? <button disabled={props.isFollowing.some((id: number) => id === user.id)}\n\t\t\t\tonClick={() => { props.unfollow(user.id) }}>\n\t\t\t\tunfollow</button>\n\t\t\t\t: <button disabled={props.isFollowing.some((id: number) => id === user.id)}\n\t\t\t\t\tonClick={() => { props.follow(user.id) }}>\n\t\t\t\t\tfollow</button>}\n\t\t</div>\n\t)\n}\n\nexport default User;\n","import React from 'react';\nimport { Field, Form, Formik } from 'formik';\nimport { getUsersFilter } from '../../../redux/users-selectors';\nimport { useSelector } from 'react-redux';\n\ntype PropsType = {\n\tonFilterChanged: (friend: null | boolean, term: string) => void\n}\ntype FormType = {\n    term: string | undefined\n    isFriend: 'true' | 'false' | 'null'\n}\nconst Search: React.FC<PropsType> = (props) => {\n\tconst filter = useSelector(getUsersFilter)\n\tconst submit = (values: FormType, { setSubmitting }: { setSubmitting: (isSubmitting: boolean) => void }) => {\n\t\tconst isFriend = values.isFriend === 'null' ? null : values.isFriend === 'true' ? true : false\n\t\tprops.onFilterChanged(isFriend, values.term as string)\n\t\tsetSubmitting(false)\n\t}\n\treturn (\n\t\t<Formik\n\t\t\tenableReinitialize\n\t\t\tinitialValues={{ term: filter.term, isFriend: String(filter.friend) as \"true\" | \"false\" | \"null\" }}\n\t\t\tonSubmit={submit}\n\t\t>\n\t\t\t{({ isSubmitting }) => (\n\t\t\t\t<Form>\n\t\t\t\t\t<Field type=\"input\" name=\"term\" />\n\t\t\t\t\t<Field as=\"select\" name=\"isFriend\">\n\t\t\t\t\t\t<option value=\"null\">all</option>\n\t\t\t\t\t\t<option value=\"true\">friend</option>\n\t\t\t\t\t\t<option value=\"false\">not friend</option>\n\t\t\t\t\t</Field>\n\t\t\t\t\t<button type=\"submit\" disabled={isSubmitting}>\n\t\t\t\t\t\tSubmit\n\t\t\t</button>\n\t\t\t\t</Form>\n\t\t\t)}\n\t\t</Formik>\n\t);\n};\n\nexport default Search","import React, { FC, useEffect } from 'react';\nimport { useDispatch, useSelector } from 'react-redux';\nimport { UserType } from '../../../redux/users-Reducer';\nimport { getCount, getIsFetching, getIsFollowing, getPage, getTotalCount, getUsers, getUsersFilter } from '../../../redux/users-selectors';\nimport Paginator from '../../common/Paginator/Paginator';\nimport Preloader from '../../common/Preloader/preloader';\nimport User from './User';\nimport { requestUsers, follow, unfollow } from '../../../redux/users-Reducer';\nimport Search from './Search';\nimport { useHistory } from 'react-router-dom';\nimport * as queryString from 'querystring'\nimport style from './Users.module.scss'\n\ntype PropsType = {\n\t\n\t\n}\n\nconst Users: FC<PropsType> = (props) => {\n\tconst totalCount = useSelector(getTotalCount)\n\tconst isFetching = useSelector(getIsFetching)\n\tconst isFollowing = useSelector(getIsFollowing)\n\tconst users = useSelector(getUsers)\n\tconst page = useSelector(getPage)\n\tconst count = useSelector(getCount)\n\tconst filter = useSelector(getUsersFilter)\n\tconst dispatch = useDispatch()\n\tconst history = useHistory()\n\n\t\n\tconst onPageChanged = (pageNumber: number) => {\n\t\tdispatch(requestUsers(pageNumber, count, filter))\n\t}\n\tconst onFilterChanged = (friend: null | boolean, term: string) => {\n\t\tdispatch(requestUsers(1, count, { term, friend }))\n\t}\n\n\tconst Follow = (id: number) => {\n\t\tdispatch(follow(id))\n\t}\n\tconst unFollow = (id: number) => {\n\t\tdispatch(unfollow(id))\n\t}\n\n\t\n\t\n\tuseEffect(() => {\n\t\tconst parsed: any = queryString.parse(history.location.search.substr(1)) \n\t\tlet actualPage = page\n\t\tlet actualFilter = filter\n\n\t\tif(!!parsed.page) actualPage = +parsed.page\n\t\tif(!!parsed.term) actualFilter.term = parsed.term\n\t\tactualFilter.friend = parsed.friend === 'null' ? null : parsed.friend === 'true' ? true : false\n\t\tdispatch(requestUsers(actualPage, count, {term: actualFilter.term, friend: actualFilter.friend}))\n\t\t// eslint-disable-next-line \n\t}, [])\n\tuseEffect(() => {\n\t\thistory.push({\n\t\t\tpathname: '/users',\n\t\t\tsearch: `?term=${filter.term}\n\t\t\t&friend=${filter.friend === null ? 'null' : filter.friend === true ? 'true' : 'false'}\n\t\t\t&page=${page}`\n\t\t})\n\t}, [filter, page])\n\t\n\tlet Paginators = <Paginator count={count}\n\t\ttotalCount={totalCount}\n\t\tpage={page}\n\t\tonPageChanged={onPageChanged} />\n\t\n\n\treturn (\n\t\t<div className={style.UsersPage}>\n\t\t\t<Search onFilterChanged={onFilterChanged} />\n\t\t\t{totalCount > count && Paginators}\n\t\t\t{isFetching ? <Preloader /> : <div >\n\t\t\t\t{users.map((user: UserType) => <User user={user}\n\t\t\t\t\tisFollowing={isFollowing}\n\t\t\t\t\tfollow={Follow}\n\t\t\t\t\tkey={user.id}\n\t\t\t\t\tunfollow={unFollow}\n\t\t\t\t/>)}\n\t\t\t\t{totalCount > count && Paginators}\n\t\t\t</div>}\n\t\t</div>\n\t)\n}\n\nexport default Users;\n"],"sourceRoot":""}